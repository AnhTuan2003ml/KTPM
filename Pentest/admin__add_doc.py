from selenium.webdriver.chrome.options import Options
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import TimeoutException, NoSuchElementException
import unittest
from time import sleep

class LoginTest(unittest.TestCase):

    def setUp(self):
        chrome_options = Options()
        chrome_options.add_argument("--window-size=800,600")
        # Khởi tạo WebDriver
        self.driver = webdriver.Chrome(options=chrome_options)

    def test_login_success(self):
        driver = self.driver
        # Mở trang web
        driver.get("http://localhost:3000/backend/admin/index.php")
        
        # Tìm các phần tử trang web
        email_field = driver.find_element(By.NAME, "ad_email")
        password_field = driver.find_element(By.NAME, "ad_pwd")
        login_button = driver.find_element(By.NAME, "admin_login")
        
        # Nhập thông tin đăng nhập đúng
        email_field.send_keys("admin@mail.com")
        password_field.send_keys("anhtuan2003")
        
        # Click vào nút đăng nhập
        login_button.click()
        
        try:
            # Đợi đến khi URL của trang thay đổi
            WebDriverWait(driver, 2).until(
                EC.url_to_be("http://localhost:3000/backend/admin/his_admin_dashboard.php")
            )
            sleep(2)
            driver.get("http://localhost:3000/backend/admin/his_admin_add_employee.php")
            driver.find_element(By.NAME,"doc_fname").send_keys("Phạm")
            driver.find_element(By.NAME,"doc_lname").send_keys('Anh Tuấn')
            mail =driver.find_element(By.NAME,"doc_email")
            mail.clear()
            mail.send_keys("tuankkffdnc@gmail.com")
            pas=driver.find_element(By.NAME,"doc_pwd")
            pas.clear()
            pas.send_keys("abcdes")
            sleep(20)
            driver.find_element(By.NAME,"add_doc").click()
            
        except TimeoutException:
            pass
        
    
    def tearDown(self):
        # Đóng trình duyệt
        self.driver.quit()

if __name__ == "__main__":
    unittest.main()
